@model Sitemaker.Models.Site
@{Layout = null;}
@Styles.Render("~/Content/StyleGray")
@Scripts.Render("~/bundles/locationContent")
@Scripts.Render("~/bundles/loadTemplate")
@Styles.Render("~/Content/Layout")
@Scripts.Render("~/scripts/jquery-3.1.0.js")



<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->

<html class="no-js" lang="en">
<!--<![endif]-->
<head>
    <style>
        .input-formName, .input-formLink, .input-formNameSide, .input-formLinkSide {
            height: 2em;
            width: 7em;
        }

        .inputs ul {
            padding: 4px;
            margin: 3px;
        }

            .inputs ul li {
                padding: 2px;
                margin: 0;
            }
            iframe {
    zoom:20%; width:60%; height:60%;border: solid;
}
    </style>

    <script>
$(document).ready(function() {

    var i = document.getElementById('topBarForm')?document.getElementById('topBarForm').getElementsByClassName('field').length + 1:0;

    var namesTop = [];
    var linksTop = [];
    var namesSide = [];
    var linksSide = [];

	$('#add').click(function () {

        if(i<19){
            $('<div style="display: inline" class="field"><ul>' +
                    '<li style="display: block;"><input type="text"  id="Name" class="input-formName" placeholder="Name"></li>' +
                        '<li style="display: block;"><input type="text"  id="Link" class="input-formLink" placeholder="Link"></li>' +
                    '</ul></div>').fadeIn('slow').appendTo('.inputs');
	    i++;
}
	});

	$('#remove').click(function() {
	if(i > 1) {
	    $('.field:last').remove();
		i--;
	}
	});



	var j = document.getElementById('sideBarForm')?document.getElementById('sideBarForm').getElementsByClassName('fieldSide').length + 1:0;

	$('#addSide').click(function () {

	    if (j< 19) {
	        $('<div style="display: inline" class="fieldSide">' +
	            '<input type="text" id="Name" class="input-formNameSide" placeholder="Name">' +
	            '<input type="text" id="Link" class="input-formLinkSide" placeholder="Link">' +
	            '</div>').fadeIn('slow').appendTo('.inputsSide');
	        j++;
	    }
	});

	$('#removeSide').click(function () {
	    if (j> 1) {
	        $('.fieldSide:last').remove();
	        j--;
	    }
	});

    // here's our click function for when the forms submitted

	

	$('#saveMenu').click(function () {


	    $('.input-formName').each(function () {
	        namesTop.push($(this).val());
	    });
	    $.each($('.input-formLink'),
	        function () {
	            linksTop.push($(this).val());
	        });

	    $('.input-formNameSide').each(function () {
	        namesSide.push($(this).val());
	    });
	    $.each($('.input-formLinkSide'),
	        function () {
	            linksSide.push($(this).val());
	        });

	    var topBar = [];
	    var sideBar = [];

	    for (var k = 0; k < namesTop.length; k++) {
	        topBar.push({
	            "Name": namesTop[k],
	            "Link": linksTop[k]
	        });
	        //topBar.set(namesTop[k], linksTop[k]);
	    }

	    for (var k = 0; k < namesSide.length; k++) {
	        sideBar.push({
	            "Name": namesSide[k],
	            "Link": linksSide[k]
	        });
	        //sideBar.set(namesSide[k], linksSide[k]);
	    }
	    
	    
	    var saveMenu = JSON.stringify({
	        'Id': @Model.Menu.Id,
	        'TopBar': topBar,
	        'SideBar': sideBar
	    });

        
	    $.ajax({
	        type: 'POST',
	        url: "/Sites/SaveMenu",
	        dataType: 'text',
	        data: saveMenu,
	        contentType: "application/json; charset=utf-8",
	        traditional: true,
	        success: function (response) {
	            window.location.replace("https://localhost:44396/Sites/FillSite/" + "@Model.UserName" + "/" +" @Model.Id");
	        },
	        fail: function () {
	            alert(data);
	        }
	        
	    });

	    
	});

});

    </script>>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">

    <title>Sitemaker</title>

    <link rel="shortcut icon" type="image/png" href="favicon.png">
    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/style.css">

    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>

<body>
    <!-- Prompt IE 7 users to install Chrome Frame -->
    <!--[if lt IE 8]><p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p><![endif]-->
    <div class="container">
        @if (Model.Menu.IsTopBarExicist)
        {
            <header id="navtop">
                <nav class="fright" id="navtop-block">

                    <div class="fright" style="margin: 2em; background: 0;">
                        <a id="add" class="button">Добавить</a> | <a id="remove" class="button">Удалить</a>
                    </div>

                    <form id="topBarForm">
                        <div style="display: block; align-content: center; clear: both">

                            <div style="display: block; width: 100%;" class="inputs">

                                @foreach(var item in Model.Menu.TopBar)
                                {
                                <div style="display: inline" class="field">
                                    <ul>
                                        <li style="display: block;"><input type="text" id="Name" class="input-formName" placeholder="Name" value=@item.Name></li>
                                        <li style="display: block;"><input type="text" id="Link" class="input-formLink" placeholder="Link" value=@item.Link></li>
                                    </ul>
                                </div>
                                }

                            </div>
                        </div>
                    </form>

                </nav>
            </header>
        }


        <div class="home-page main">
            <hr>

            @if (Model.Menu.IsSideBarExicist)
            {
                <aside class="grid col-one-quarter mq2-col-full">
                    <div class="grid-wrap">
                        <menu id="navside-block">
                            <p class="fleft">
                                <h3>Menu</h3>
                            </p>

                            <div class="fleft" style="height: 9em; background: 0;">
                                <p><a id="addSide" class="button">Добавить</a>
                                </p>
                                <p></p>
                                <p><a id="removeSide" class="button">Удалить</a></p>
                            </div>

                            <form id="sideBarForm">
                                <div style="display: block; align-content: center; clear: both">

                                    <div style="display: block; width: 100%; margin: 4px;" class="inputsSide">

                                        @foreach (var item in Model.Menu.SideBar)
                                        {
                                            <div style="display: inline" class="fieldSide">
                                                <input type="text" id="Name" class="input-formNameSide" placeholder="Name" value=@item.Name>
                                                <input type="text" id="Link" class="input-formLinkSide" placeholder="Link" value=@item.Link>
                                            </div>
                                        }

                                    </div>
                                </div>
                            </form>



                        </menu>
                    </div>
                </aside>
            }
@foreach (var page in Model.Pages)
{
    <section class="grid-wrap">
        <div class="grid-wrap">

            <input type="text" style="border: none;" value="@Url.Action("PageView", "Sites", new {userName = Model.UserName, id = Model.Id, pageId = @page.Id})" />
            <iframe src="@Url.Action("PageView", "Sites", new {userName = Model.UserName, id = Model.Id, pageId = @page.Id})"> </iframe>
            

        </div>
    </section>
}
                <div class="grid-wrap" style="align-content: center">
                    <a id="saveMenu" class="button">Save menu</a>
                </div>
            

        </div> <!--main-->
        
    </div>
    <!-- Javascript - jQuery -->
    <script src="http://code.jquery.com/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
    <script src="//widget.cloudinary.com/global/all.js" type="text/javascript"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.7.2.min.js"><\/script>')</script>
    <!--[if (gte IE 6)&(lte IE 8)]>
    <script src="js/selectivizr.js"></script>
    <![endif]-->
    <script src="js/jquery.flexslider-min.js"></script>
    <script src="js/scripts.js"></script>
    <script src="//widget.cloudinary.com/global/all.js" type="text/javascript"></script>
    <!-- Asynchronous Google Analytics snippet. Change UA-XXXXX-X to be your site's ID. -->
    <script>
  var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
                g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
                s.parentNode.insertBefore(g,s)}(document,'script'));
    </script>
</body>
</html>






